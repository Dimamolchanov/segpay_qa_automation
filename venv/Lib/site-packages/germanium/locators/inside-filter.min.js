return function(){function a(a,b){for(h=i.shift(),b=b?b:1;h--;)if(a.push(i.shift()),2==b){for(var c=i.shift().split(","),d=[],e=0;e<c.length;e++)d.push(parseInt(c[e]));a.push(d)}}function b(a,b){if(!b||!a)return!1;for(;b;){if(b==a)return!0;b=b.parentNode}return!1}var c,d,e,f,g,h,i,j=[],k=[],l=[],m=[],n=[];for(i=[],e=0;e<arguments.length;e++)i.push(arguments[e]);if(d=i.shift(),a(j),a(k),a(l),c=i.shift(),a(m,2),a(n),d)for(e=n.length-1;e>=0;e--)n[e].childNodes&&n[e].childNodes.length&&n.splice(e,1);if(j.length)a:for(e=n.length-1;e>=0;e--){for(f=0;f<j.length;f++)if(b(j[f],n[e]))continue a;n.splice(e,1)}if(k.length)a:for(e=n.length-1;e>=0;e--){for(f=0;f<k.length;f++)if(b(n[e],k[f]))continue a;n.splice(e,1)}if(m.length)a:for(e=n.length-1;e>=0;e--){var o={};for(g=0;g<c;g++)o[g]=!0;for(f=0;f<m.length;f+=2)if(o[m[f+1]]&&b(n[e],m[f]))for(g=0;g<m[f+1].length;g++)delete o[m[f+1][g]];for(g=0;g<c;g++)if(o[g]){n.splice(e,1);continue a}}a:for(var e=n.length-1;e>=0;e--)for(var p=n[e],f=0;f<l.length;f++){var q=l[f];if(b(q,p)){n.splice(e,1);continue a}}return n}.apply(this,arguments);